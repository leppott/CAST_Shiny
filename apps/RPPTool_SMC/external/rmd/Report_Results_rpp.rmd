---
title: "Report, Summary, RPP"
subtitle: "CAST"
author: "`r Sys.getenv('USERNAME')`"
date: "`r format(Sys.time(), '%Y-%m-%d %H:%M:%S')`"
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float: yes
  word_document:
    toc: yes
  pdf_document:
    toc: true
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(results='asis', echo=FALSE, warning=FALSE)
# Debugging
boo.DEBUG <- FALSE
DEBUG.CaseNumber <- 4
#
# Define pipe
`%>%` <- dplyr::`%>%`
#
if(boo.DEBUG==TRUE){##IF.boo.DEBUG.START
  if(DEBUG.CaseNumber==1){##IF.DEBUG.CaseNumber.START
    TargetSiteID <- "20341801"
    dir_results <- file.path("Results")
    probsHigh <- 0.75
    probsLow <- 0.25
    report_format="html"
  } else if(DEBUG.CaseNumber==2){
    TargetSiteID <- "907S02774"
    dir_results <- "C:/Users/ann.lincoln/Documents/SEP_CAST/Results"
  } else if(DEBUG.CaseNumber==3){
    TargetSiteID <- "403S01272"
    dir_results <- "C:/Users/ann.lincoln/Documents/SEP_CAST/Results"
  } else if(DEBUG.CaseNumber==4){
    TargetSiteID <- "905S15201"
    dir_data <- "C:/Users/ann.lincoln/Documents/SEP_CAST/Data"
    dir_results <- "C:/Users/ann.lincoln/Documents/SEP_CAST/Results"
    probsHigh <- 0.75
    probsLow <- 0.25
    useAlg <- FALSE
    useBMI <- TRUE
    report_format="html"
    removeOutliers <- TRUE
    useBC <- TRUE # Use Bray-Curtis biological dissimilarity distance matrix
    lagdays=10
    siteQual2Plot = stringr::str_to_sentence("not degraded") # options:"reference","better than","not degraded"
  }##IF.DEBUG.CaseNumber.END
}##IF.boo.DEBUG.END

```

# **REPORT INFORMATION**

```{r report_date}
  myReportDate <- format(Sys.time(), "%Y-%m-%d %H:%M:%S")
  cat(paste("**Report Date and Time:** ",myReportDate,"\n\n",sep=""))
  myUser <- Sys.getenv("USERNAME")
  cat(paste("**Generated By:** ",myUser,"\n\n",sep=""))
  # cat(paste("**CASTfxn Package Version:** ",packageVersion("CASTfxn"),"\n\n",sep=""))
  
  cat("**Selected parameters:**\n\n")
  cat(paste("\tRemove outliers? ",removeOutliers,"\n",sep=""))
  cat(paste("\tUse expected biological similarity filter? ",useBC,"\n",sep=""))
  cat(paste("\tNumber of days lag time between stressor and response sample collection = ",lagdays,"\n",sep=""))
#<<<<<<< 201909_ARL
  cat(paste("\tQuality of site displayed on analysis graphics? ",siteQual2Plot,"\n",sep=""))
  cat(paste("\tLower and upper percentiles for identifying stressors = ",probsLow
#=======
# # siteQual2Plot = stringr::str_to_sentence("not degraded") # options:"reference","better than","not degraded"
#  #cat(paste("\tQuality of site displayed on analysis graphics? ",siteQual2Plot,"\n",sep=""))
#  cat(paste("\tLower and upper quantiles for identifying stressors = ",probsLow
#>>>>>>> master
            , "-", probsHigh, "\n",sep=""))
  # cat(paste("\tLimit above which DO is not identified as a stressor = ",DOlim
  #           , "\n",sep=""))
  # cat(paste("\tLimits between which pH is not identified as a stressor = ",pHlimLow
  #           , " and ", pHlimHigh, "\n\n",sep=""))

```

# **SITE INFORMATION**

```{r SiteID}
#list.dirs(file.path(getwd(), "Results"), full.names=FALSE, recursive=FALSE)

  cat(paste("**Site ID:** ",TargetSiteID,"\n\n",sep=""))
```

```{r map, out.width="70%"}
dir_base <- "C:/Users/Erik.Leppo/OneDrive - Tetra Tech, Inc/MyDocs_OneDrive/GitHub/CASTfxn/inst/shiny-examples/RPPTool_SMC"
dir_results <- file.path(dir_base, "Results")
TargetSiteID <- "20341801"

myMAP <- list.files(path = file.path(dir_results, TargetSiteID)
                    , pattern = "_ConnectedReaches_"
                    )


fn_img <- file.path(dir_results, TargetSiteID, myMAP)
if(file.exists(fn_img)==TRUE) {
  knitr::include_graphics(fn_img)
} else {
  cat("No file exists; map.\n")
}

# results plot
myPLOT <- list.files(path = file.path(dir_results, TargetSiteID)
                    , pattern = "_AllScores_"
                    ) 
fn_img <- file.path(dir_results, TargetSiteID, myPLOT)
if(file.exists(fn_img)==TRUE) {
  knitr::include_graphics(fn_img)
} else {
  cat("No file exists; map.\n")
}


# Table


```



